# 데이터 분석 상세 계획 (Analysis Plan)

본 문서는 `seoul-subway-monitor` 프로젝트의 데이터 분석 목표와 방법론을 상세히 기술합니다.

## 1. 개요
서울시 지하철 실시간 위치 데이터를 적재한 후, 운행 정시성, 지연 구간, 회차 효율성 등을 분석하여 운영 최적화 인사이트를 도출합니다.

## 2. 주요 분석 항목

### 1) 배차 간격 정기성 분석 (Interval Regularity)
- **목적**: 특정 역에 도착하는 열차들 사이의 시간 간격을 계산하여 배차 간격 준수 여부 확인.
- **방법**:
    - 동일 역(`station_id`), 동일 호선(`line_id`), 동일 방향(`direction_type`)의 열차 도착 시간(`created_at` 또는 `last_rec_time`) 차이 계산.
    - 배차 간격의 표준 편차 산출.
    - **Bunching(열차 뭉침)** 또는 **Gapping(간격 벌어짐)** 현상 탐지.

### 2) 지연 발생구간 탐지 (Delay Hotspots)
- **목적**: 상습적인 지연이 발생하는 역 또는 구간 식별.
- **방법**:
    - 역별 체류 시간 분석: `train_status`가 '도착(1)'에서 '출발(2)'로 바뀌는 시간 차이 계산.
    - 역간 주행 시간 분석: A역 출발 -> B역 도착 소요 시간 측정.
    - 평시 대비 과도한 체류/주행 시간이 발생하는 구간 시각화.

### 3) 회차 효율성 분석 (Turnaround Efficiency)
- **목적**: 종착역에서의 회차 운영 효율성 진단.
- **방법**:
    - 종착역(`dest_station_id`와 현재 `station_id`가 일치) 도착 후, 해당 열차 번호(`train_number`)가 반대 방향(`direction_type` 변경)으로 다시 운행을 시작하기까지의 시간 측정.
    - 회차 소요 시간 분포 및 병목 지점 파악.

### 4) 급행/일반 열차 간섭 분석 (Congestion/Overtake)
- **목적**: 급행 열차와 일반 열차 간의 간섭으로 인한 지연 원인 파악.
- **방법**:
    - 급행(`is_express`=1)과 일반(`is_express`=0) 열차의 위치 관계 추적.
    - 급행 열차가 일반 열차를 추월하는 지점 전후의 속도 저하 또는 대기 시간 분석.
    - 대피선 활용 적절성 평가.

## 3. 데이터 활용 예시
- 대시보드 시각화: 실시간 지연 맵(Heatmap), 노선별 배차 간격 그래프.
- 알림 시스템: 특정 구간 지연 심화 시 관리자 알림.
